# Приложение гостевая книга.

Возможности:
- Добавлять записи с указыванием Имени, сообщения. Так же фиксируется время отправки.
- Просматривать все сохранённые записи
- Версия фронтенда, бэкенда и serverless функции. Меняется при обновлении фронтенда или бэкенда

Технологии:
- python для serverless функции, автоматически масштабируется под нагрузку
- статический html+css+js для фронтенда, доступен из object storage
- ydb для хранения записей
- api gateway для скрытия реализции и предоставления доступа к статическому фронтенду и функции бэкенда
- bash скрипты с использованием yandex cli (`yc`) для:
  - создания приложения с нуля в каталоге (версия фронтенда и бэкенда 1.0)
  - загрузки схемы ydb через одноразовую serverless функцию
  - обновление кода фронтенда с увеличением версии (1.0 -> 1.1)
  - обновление кода бэкенда с увеличением версии (1.0 -> 1.1)
  - удаления всех созданных сущностей

Ссылка на api-gateway, по которому доступно приложение - https://d5d4ajf500b8huitpmvr.lievo6ut.apigw.yandexcloud.net/

# Как запустить

Скрипты на bash, проверял на linux. Запускал для двух своих разных облаков.

Перед запуском скриптов отредактируйте `config.sh`:
- `YC_FOLDER_ID`: ID каталога в облаке Yandex cloud.
- `YC_BUCKET_NAME`: Название для бакета в object storage. Уникальное для всех пользователей Yandex cloud.
- `YC_FUNCTION_NAME`: Название для основной Serverless Function.
- `YC_API_GATEWAY_NAME`: Название для API Gateway.
- `YC_DB_NAME`: Название для базы данных YDB.
- `YC_SA_NAME`: Название для сервисного аккаунта, под которым функция будет ходить в YDB.
Сейчас в файле настройки, под которыми я разворачивал свою версию. На неё ведёт ссылка выше.

Выполнять скрипты из папки `scripts`
```bash
cd scripts
```

Выдача прав на исполнение (в репозитории права у файлов скорее всего уже есть)
```bash
chmod +x *.sh
```

Создание всех сущностей с нуля + схемы YDB. После успешного выполнения приложение готово к использованию
```bash
./create_all.sh; ./create_schema.sh
```

Удаление всего, потом снова создание всех сущностей с нуля + схемы YDB. 
```bash
./destroy_all.sh; ./create_all.sh; ./create_schema.sh
```

Обновление кода фронтенда и автоматический инкремент его версии. После обновления версия фронтенда на сайте изменится
```bash
./update_frontend.sh
```

Обновление кода бэкенда и автоматический инкремент его версии. После обновления версия бэкенда и serverless функции на сайте изменится
```bash
./update_backend.sh
```

Все команды по одной:
```bash
./create_all.sh
```
```bash
./create_schema.sh
```
```bash
./update_frontend.sh
```
```bash
./update_backend.sh
```
```bash
./destroy_all.sh
```
